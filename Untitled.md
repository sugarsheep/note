双重判断

![1571490924099](images/1571490924099.png)

![1571492502926](images/1571492502926.png)

![1571492642796](images/1571492642796.png)

![1571746863247](images/1571746863247.png)

![1571748768635](images/1571748768635.png)

![1575112350844](images/1575112350844.png)

oozie构建流程

| index | current            | next     | end（链表） |
| ----- | ------------------ | -------- | ----------- |
| 1     | **start(load)**    | fork-1   | join-1      |
| 2     | fork-1(1)          | 资源表1  | join-1      |
| 3     | **资源表1(load)**  | 数据拆分 | join-1      |
| 4     | **数据拆分(load)** | fork-2   | join-2      |
| 5     | fork-2             | 分层采样 | join-2      |
| 6     | **分层采样**       | join-2   | join-1      |
| 7     | join-1             | end      |             |
| 8     | **fork-2**         | 条件     | join-2      |
| 9     | 条件               | 分层     | join-2      |
|       |                    |          |             |
|       |                    |          |             |
|       |                    |          |             |
|       |                    |          |             |
|       |                    |          |             |
|       |                    |          |             |
|       |                    |          |             |
|       |                    |          |             |
|       |                    |          |             |
|       |                    |          |             |

